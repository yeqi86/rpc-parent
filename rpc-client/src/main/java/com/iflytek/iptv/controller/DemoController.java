package com.iflytek.iptv.controller;import com.iflytek.iptv.api.DemoApi;import com.iflytek.iptv.dto.EventMsg;import com.iflytek.sdk.client.rpc.RpcServiceFactory;import com.iflytek.sdk.client.websocket.WebsocketClient;import com.iflytek.sdk.exception.ClassNotQualifiedException;import io.netty.channel.Channel;import io.netty.handler.codec.http.websocketx.TextWebSocketFrame;import lombok.extern.slf4j.Slf4j;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import org.springframework.web.bind.annotation.ResponseBody;import org.springframework.web.bind.annotation.RestController;import java.net.URISyntaxException;/** * Created by Administrator on 2019/4/24. */@Slf4j@RestControllerpublic class DemoController {    Channel channel;    /**     * demo     */    @RequestMapping(value = "/getTest/demo", method = RequestMethod.GET)    @ResponseBody    public void listPage(String time) throws ClassNotQualifiedException {        DemoApi api  =  RpcServiceFactory.getClass(DemoApi.class,"127.0.0.1:1232");        //  ServerTransferApi api  =  RpcServiceFactory.getClass(ServerTransferApi.class,"127.0.0.1:1321");        EventMsg msg = new EventMsg();        msg.setName("xunfei00040002");        msg.setMsg("/home/lc/1.原始资源/【教育】/安徽名师联盟/未上线/其他/xunfei00040002.mp4");         api.sendMsg(msg);        return;    }    @RequestMapping(value = "/getTest/demo2", method = RequestMethod.GET)    @ResponseBody    public void listPage2(String time) throws ClassNotQualifiedException, URISyntaxException, InterruptedException {        if(channel == null) {            channel = WebsocketClient.connectToServer("http://127.0.0.1:1232?userid=1234");        }        TextWebSocketFrame frame = new TextWebSocketFrame("你好\r\n");        channel.writeAndFlush(frame);        return;    }}